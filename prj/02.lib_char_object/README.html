<h1 id="">キャラクタ制御クラスとサンプル</h1>
<h2 id="-1">概要</h2>
<ul>
<li>キャラクタの生成（<code>prj/lib/CharFactory.ts</code>）</li>
<li>キャラクタの制御（<code>prj/lib/CharEntity.ts</code>）</li>
<li>上記の動作確認（<code>prj/02.lib_char_object/src/main.ts</code>）</li>
</ul>
<h2 id="-2">使い方</h2>
<h3 id="-4">起動</h3>
<pre><code class="sh language-sh">npm run debug # access to http://localhost:3000
</code></pre>
<h3 id="-5">画面</h3>
<p><img src="./screen.png" alt="スクリーンショット" /></p>
<dl>
  <dt style="color:red">■ Direction</dt>
  <dd>向きを変える</dd>
  <dt style="color:blue">■ Action</dt>
  <dd>アクションを切り替える</dd>
  <dt style="color:green">■ Mental</dt>
  <dd>エフェクトを切り替える</dd>
  <dt style="color:cyan">■ Damage</dt>
  <dd>ダメージ状態（点滅）</dd>
  <dt style="color:gray">■ Collision</dt>
  <dd>当たり判定確認要（ドラッグ可能）</dd>
  <dt>上下に揺れるキャラクタ</dt>
  <dd>公式のサンプル（削除してないだけ）</dd>
  <dt>マントを着けたキャラクタ</dt>
  <dd>生成したキャラクタ</dd>
</dl>
<h2 id="-3">詳細</h2>
<h3 id="prjlibcharfactoryts">キャラクタの生成（<code>prj/lib/CharFactory.ts</code>）</h3>
<pre><code class="ts language-ts">/**
 * 前提：アセットが読み込まれていること
 * - エフェクト用画像：/assets/image/obj/effects.png
 * - キャラクタ設定json：/assets/data/char_sprite_settings.json
 *   （prj/01.collision_editor で作成した設定json）
 */
const scene = new g.Scene({
  game: g.game,
  assetPaths: ["/assets/**/*"]
});
</code></pre>
<pre><code class="ts language-ts">/**
 * 適切にアセットが読み込まれていれば、名前を指定してインスタンスが取得できる
 */
const hero:CharEntity = CharFactory.getCharObject("hero");
</code></pre>
<h3 id="prjlibcharentityts">キャラクタの制御（<code>prj/lib/CharEntity.ts</code>）</h3>
<pre><code class="ts language-ts">// CharFactory 参照
const hero:CharEntity = CharFactory.getCharObject("hero");
</code></pre>
<pre><code class="ts language-ts">// キャラクタのアニメーションなどを指定する
hero.setDirection("left");
hero.setAction("walk");
hero.setMental("sleep");
hero.setDamage();
// 移動は他のエンティティと同様
hero.x += 10;
hero.modified();
</code></pre>
<pre><code class="ts language-ts">// 当たり判定のサンプルコード
const hit = g.Collision.intersectEntities(rect, hero.getHitArea());
rect.cssColor = hit ? "yellow" : "black";
rect.modified();
</code></pre>
<h3 id="prj02lib_char_objectsrcmaints">上記の動作確認（<code>prj/02.lib_char_object/src/main.ts</code>）</h3>
<p><a href="#画面">画面</a>参照</p>